CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Dim WithEvents listViewVeranstaltung As MSComctlLib.ListView
Attribute listViewVeranstaltung.VB_VarHelpID = -1

'Dim veranstaltungNameOK, veranstaltungAnfangOK, veranstaltungEndeOK, veranstaltungOrtOK As Boolean

Private blnGood As Boolean

Private Sub btnLoeschen_Click()

    'Wenn nicht neuer Eintrag
    If Form.NewRecord = False Then

        'Warnung unterdrücken
        DoCmd.SetWarnings False
    
        If MsgBox("Veranstaltung löschen?" & vbCrLf & _
                  "Soll die Veranstaltung: " & vbCrLf & vbCrLf & Me.txtVeranstaltungName & vbCrLf & vbCrLf & "gelöscht werden?", vbYesNo, "Veranstaltung löschen") = vbYes Then
            DoCmd.RunCommand acCmdDeleteRecord
            DoCmd.SetWarnings True
            Form.Refresh
            DoCmd.GoToRecord , , acLast
            'Me.lstVeranstaltung.SetFocus
        End If

    End If

    If Form.NewRecord = True Then
        Form.Undo
    End If
    'Application.DisplayAlerts = False
    

End Sub

Private Sub btnSpeichern_Click()

    blnGood = True
    Call DoCmd.RunCommand(acCmdSaveRecord)
    blnGood = False

End Sub

Private Sub dateVeranstaltungAnfang_GotFocus()
    Debug.Print Me.dateVeranstaltungAnfang.TextAlign
    'Me.dateVeranstaltungAnfang.SetFocus
    Me.dateVeranstaltungAnfang.SelStart = 4
End Sub

Private Sub dateVeranstaltungEnde_BeforeUpdate(Cancel As Integer)
    If Me.dateVeranstaltungEnde < Me.dateVeranstaltungAnfang Then
        MsgBox "Ende für Veranstaltung muss vor Anfang sein - Bitte korrigieren"
        Me.dateVeranstaltungEnde.Undo
        Cancel = True
    End If
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    'Dim strMsg As String
    '
    '    If Not blnGood Then
    '        Cancel = True
    '        strMsg = "Please use the Save button to save your changes," & _
    '                 vbNewLine & "or Escape to reset them."
    '        Call MsgBox(Prompt:=strMsg, Title:="Before Update")
    '    End If

End Sub

Private Sub Form_Load()

''''''''''''''''''''''''''''''''''''''

'Me.txtTest = idEvent
'''''''''''''''''''''''''''''''''''''

'    Set listViewVeranstaltung = Me!lstviewVeranstaltung.Object
'
'    With listViewVeranstaltung
'
'        .View = lvwReport
'
'        .View = lvwReport
'         .Appearance = ccFlat
'         .BorderStyle = ccNone
'         .FlatScrollBar = False
'         .GridLines = True
'         .FullRowSelect = True
'
'         .ColumnHeaders.Clear
'
'        .ColumnHeaders.Add , , "VeranstaltungID"
'        .ColumnHeaders.Add , , "Veranstaltung Name"
'        .ColumnHeaders.Add , , "Veranstaltung Beginn"
'        .ColumnHeaders.Add , , "Veranstaltung Ende"
'        .ColumnHeaders.Add , , "Veranstaltung Ort"
'
'    End With
'
'   ' Call ListViewFuellen
'
'End Sub
'
'Public Sub test()
'
'    MsgBox "test"
'
'End Sub
'
'
'Private Sub ListViewFuellen()
'    Dim db As DAO.Database
'    Dim rst As DAO.Recordset
'    Dim objListitem As MSComctlLib.ListItem
'    Set db = CurrentDb
'    Set rst = db.OpenRecordset("SELECT idVeranstaltung, txtVeranstaltungName, dateVeranstaltungAnfang, dateVeranstaltungEnde, Veranstaltungsort FROM tblVeranstaltung", dbOpenDynaset)
'    Do While Not rst.EOF
'        Set objListitem = listViewVeranstaltung.ListItems.Add(, "pp" & rst!idVeranstaltung, rst!idVeranstaltung)
'        With objListitem
'            .ListSubItems.Add , , rst!txtVeranstaltungName
'            .ListSubItems.Add , , rst!dateVeranstaltungAnfang
'            .ListSubItems.Add , , rst!dateVeranstaltungEnde
'            .ListSubItems.Add , , rst!Veranstaltungsort
'        End With
'        rst.MoveNext
'    Loop
'    rst.Close
'    Set rst = Nothing
'    Set db = Nothing
'End Sub


'Private Sub listViewVeranstaltung_OnItemSelectionChanged(e As ListViewItemSelectionChangedEventArgs)
'MsgBox "Test"
End Sub
