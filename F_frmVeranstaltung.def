CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Public okStart As Boolean
Public okStop As Boolean
Public okOrt As Boolean

'Dim veranstaltungNameOK, veranstaltungAnfangOK, veranstaltungEndeOK, veranstaltungOrtOK As Boolean

Private blnGood As Boolean


Private Sub btnDuplizieren_Click()

    blnGood = True
    DoCmd.RunMacro "duplicateRecord"
    blnGood = False

End Sub

Private Sub btnLoeschen_Click()

    'Wenn nicht neuer Eintrag
    If Form.NewRecord = False Then

        'Warnung unterdrücken
        DoCmd.SetWarnings False
    
        If MsgBox("Veranstaltung löschen?" & vbCrLf & _
            "Soll die Veranstaltung: " & vbCrLf & vbCrLf & Me.txtVeranstaltungName & vbCrLf & vbCrLf & "gelöscht werden?", vbYesNo, "Veranstaltung löschen") = vbYes Then
            DoCmd.RunCommand acCmdDeleteRecord
            DoCmd.SetWarnings True
            Form.Refresh
            DoCmd.GoToRecord , , acLast
            'Me.lstVeranstaltung.SetFocus
        End If

    End If

    If Form.NewRecord = True Then
        Form.Undo
    End If
    'Application.DisplayAlerts = False
    

End Sub

Private Sub btnSpeichern_Click()

    If okStop = True And okOrt = True Then

        blnGood = True
        Call DoCmd.RunCommand(acCmdSaveRecord)
        blnGood = False
        Me.Refresh

    End If

    

End Sub

Private Sub dateVeranstaltungAnfang_GotFocus()
    Debug.Print Me.dateVeranstaltungAnfang.TextAlign
    'Me.dateVeranstaltungAnfang.SetFocus
    Me.dateVeranstaltungAnfang.SelStart = 4
End Sub



Private Sub dateVeranstaltungEnde_BeforeUpdate(Cancel As Integer)
    If Me.dateVeranstaltungEnde < Me.dateVeranstaltungAnfang Then
        okStop = False
        DoCmd.SetWarnings False
        MsgBox "Ende für Veranstaltung muss vor Anfang sein - Bitte korrigieren"
        Me.dateVeranstaltungEnde.Undo
        'Me.dateVeranstaltungEnde = Me.dateVeranstaltungAnfang
        Cancel = True
        
        '    DoCmd.SetWarnings True
    End If
    
    If Me.dateVeranstaltungEnde > Me.dateVeranstaltungAnfang Then
        okStop = True
    End If
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)

    Dim strMsg As String
    
    If Not blnGood Then
        Cancel = True
        'strMsg = "Please use the Save button to save your changes," & _
         vbNewLine & "or Escape to reset them."
        'Call MsgBox(Prompt:=strMsg, Title:="Before Update")
    End If

End Sub

Private Sub Form_Load()

    okStart = False
    okStop = False
    okOrt = False

End Sub

Private Sub Veranstaltungsort_BeforeUpdate(Cancel As Integer)
If Not Me.Veranstaltungsort = "" Then
okOrt = True
End If
End Sub
